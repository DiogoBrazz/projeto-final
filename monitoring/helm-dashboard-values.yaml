grafana:
  adminPassword: "senha123" # ou use um secret para mais segurança

  service:
    type: LoadBalancer
    portName: http
    port: 80
    targetPort: 3000

  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      labelValue: "1"

  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: Prometheus
          type: prometheus
          url: http://prometheus-stack-kube-prom-prometheus.monitoring.svc.cluster.local:9090
          access: proxy
          isDefault: true

  dashboards:
    default:
      projeto-final-dashboard:
        label: grafana_dashboard
        labelValue: "1"
        json: >-
          {
            "title": "Visão Geral do Cluster",
            "schemaVersion": 39,
            "refresh": "10s",
            "time": {
              "from": "now-1h",
              "to": "now"
            },
            "panels": [
              {
                "id": 1,
                "title": "Uso de CPU (%)",
                "type": "timeseries",
                "datasource": "Prometheus",
                "targets": [
                  {
                    "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))) * 100",
                    "refId": "A"
                  }
                ],
                "fieldConfig": {
                  "defaults": {
                    "unit": "percent"
                  }
                },
                "gridPos": { "h": 8, "w": 24, "x": 0, "y": 0 }
              },
              {
                "id": 2,
                "title": "Uso de Memória (%)",
                "type": "timeseries",
                "datasource": "Prometheus",
                "targets": [
                  {
                    "expr": "(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100",
                    "refId": "A"
                  }
                ],
                "fieldConfig": {
                  "defaults": {
                    "unit": "percent"
                  }
                },
                "gridPos": { "h": 8, "w": 24, "x": 0, "y": 8 }
              },
              {
                "id": 3,
                "title": "Pods em Execução",
                "type": "stat",
                "datasource": "Prometheus",
                "targets": [
                  {
                    "expr": "sum(kube_pod_status_phase{phase=\"Running\"})",
                    "refId": "A"
                  }
                ],
                "gridPos": { "h": 4, "w": 8, "x": 0, "y": 16 }
              },
              {
                "id": 4,
                "title": "Pods Pendentes",
                "type": "stat",
                "datasource": "Prometheus",
                "targets": [
                  {
                    "expr": "sum(kube_pod_status_phase{phase=\"Pending\"})",
                    "refId": "A"
                  }
                ],
                "gridPos": { "h": 4, "w": 8, "x": 8, "y": 16 }
              },
              {
                "id": 5,
                "title": "Pods com Falha",
                "type": "stat",
                "datasource": "Prometheus",
                "targets": [
                  {
                    "expr": "sum(kube_pod_status_phase{phase=\"Failed\"})",
                    "refId": "A"
                  }
                ],
                "gridPos": { "h": 4, "w": 8, "x": 16, "y": 16 }
              }
            ]
          }

prometheus-operator:
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
