grafana:
  adminPassword: "senha123" # ou use um secret para mais segurança

  service:
    type: LoadBalancer
    portName: http
    port: 80
    targetPort: 3000

  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      labelValue: "1"

  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: Prometheus
          type: prometheus
          url: http://prometheus-stack-kube-prometheus-prometheus.monitoring.svc.cluster.local:9090
          access: proxy
          
  dashboards:
    default:
      projeto-final-dashboard:
        # Seu JSON do dashboard continua aqui, sem alterações.
        json: >-
          {"title":"Visão Geral do Cluster - Projeto Final","schemaVersion":39,"style":"dark","tags":[],"timezone":"browser","editable":true,"version":1,"refresh":"10s","time":{"from":"now-1h","to":"now"},"panels":[{"id":1,"title":"Uso de CPU do Cluster (%)","type":"timeseries","datasource":"Prometheus","gridPos":{"h":8,"w":24,"x":0,"y":0},"fieldConfig":{"defaults":{"unit":"percent","color":{"mode":"palette-classic"},"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}}},"targets":[{"refId":"A","expr":"(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))) * 100","legendFormat":"Uso de CPU"}]},{"id":2,"title":"Uso de Memória do Cluster (%)","type":"timeseries","datasource":"Prometheus","gridPos":{"h":8,"w":24,"x":0,"y":8},"fieldConfig":{"defaults":{"unit":"percent","color":{"mode":"palette-classic"},"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}}},"targets":[{"refId":"A","expr":"(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100","legendFormat":"Uso de Memória"}]},{"id":3,"title":"Pods em Execução","type":"stat","datasource":"Prometheus","gridPos":{"h":4,"w":8,"x":0,"y":16},"targets":[{"refId":"A","expr":"sum(kube_pod_status_phase{phase=\"Running\"})"}]},{"id":4,"title":"Pods Pendentes","type":"stat","datasource":"Prometheus","gridPos":{"h":4,"w":8,"x":8,"y":16},"targets":[{"refId":"A","expr":"sum(kube_pod_status_phase{phase=\"Pending\"})"}]},{"id":5,"title":"Pods com Falha","type":"stat","datasource":"Prometheus","gridPos":{"h":4,"w":8,"x":16,"y":16},"targets":[{"refId":"A","expr":"sum(kube_pod_status_phase{phase=\"Failed\"})"}]}]}

prometheus-operator:
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi